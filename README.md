<h1>FCMPROXY</h1>

Google Firebase Cloud Messaging (FCM) is Google's **cross-platform service** for sending **instant data messages** and notifications.

Key features:

- Cross-platform delivery: works across to apps, across Android, iOS, and **web apps**,
- Notification messages supporting store-and-forward (User chat via instant messenging, etc.)
- Data Messages (data syncing, Inter-Process communication, etc.)
- Uses a server based, reliable API.

FCMPROXY is a **Free** iframe-based proxy solution for easy integration of Google Firebase Cloud Messaging.

This **FREE** (*) module allows most web sites (**) to use Firebase Cloud Messaging. It is based on developments realized in the frame of the radiahub-105 Firebase Project and is one of the front-ends using the FCM server API deployed on  [radiahub server](https://radiahub/22web.org/)

The client part of the source code is available on [GitHub](#radiahub-public-repositories-on-github)

More about Google FCM on [wikipedia](https://en.wikipedia.org/wiki/Firebase_Cloud_Messaging)

<br>

Licensed under [MIT License](https://github.com/radiahub/fcmproxy?tab=MIT-1-ov-file)

<br>

---

<br>

(*)
FCMPROXY is free for all users (private, corporate), provided the user has registered to radiahub services and obtained an API key.

<br>

(**)
**Important**:<br>
Most free hosting service providers protect automatically and in a non-configurable way the hosted web sites, by:

- Denying CORS (Cross-Origin Resources Sharing),
- Enforcing a strict Same Origin Policy, 

both actions will prevent the launching of their hosted web pages in an IFrame.

These policies are configurable on most premium hosting service providers, in which case it should be possible to authorize the service to interact specifically with the subdomain radiahub.22web.org while your other service retain their respective security settings.

<br>

Denis can assist you to integrate Google Firebase Cloud Messaging by deploying a dedicated front-end to FCM on your web app, or by developing a bespoke solution taylored to your needs:


[contact Denis](https://radiahub.22web.org/?run=&view=contact)

[Hire me](https://radiahub.22web.org/?run=&view=hire_me)

<br>&nbsp;
<br>

# Table of Contents<br>

- [Table of Contents](#table-of-contents)
- [Presentation](#presentation)
	- [Advantages](#advantages)
	- [Pre-requisites](#pre-requisites)
	- [Referencing FCM tokens](#referencing-fcm-tokens)
	- [radiahub message format](#radiahub-message-format)
- [Integration of your web site](#integration-of-your-web-site)
	- [Download and bind script fcmproxy.js](#download-and-bind-script-fcmproxyjs)
		- [Download from GitHub repository](#download-from-github-repository)
		- [Bind script](#bind-script)
	- [Initialize fcmproxy object](#initialize-fcmproxy-object)
- [FCMPROXY reference](#fcmproxy-reference)
	- [Bind fcmproxy to your website](#bind-fcmproxy-to-your-website)
	- [fcmproxy object properties](#fcmproxy-object-properties)
- [Free code and free applications are **showcases** catching your attention!](#free-code-and-free-applications-are-showcases-catching-your-attention)
- [API for manual handling of FCM tokens](#api-for-manual-handling-of-fcm-tokens)
	- [Register FCM token](#register-fcm-token)
	- [Unregister FCM token](#unregister-fcm-token)
- [radiahub public repositories on GitHub](#radiahub-public-repositories-on-github)

<br>&nbsp;
<br>

# Presentation


## Advantages

- 100% Free usage (for radiahub-registered users websites only),
- Comfortable Fair Usage Practice (FUP) set by default to 50000 messages per day,
- Does not require to create a Google development account,
- Avoids some pretty cumbersome development and testing headache,
- Front-end to your application based on pure JavaScript (asynchronous), does not require additional extensions,
- Use FCMPROXY to communicate with instant messages through various devices and platforms (web pages, Android apps, IOS apps, etc.) within radiahub or with other applications (why not your application?)


## Pre-requisites

- Your web site must be able to run in an iframe (not only in top-level)
- You must register for an API key 
	- at web page http://radiahub.22web.org/
	- [using Google Forms](https://docs.google.com/forms/d/e/1FAIpQLSfxhndoVHp21zhWzkvZysKdd58_5FXRy3CM_K9KMDqVJbyRcw/viewform?usp=publish-editor)
	- using radiahub authenticator application [download here](https://drive.google.com/file/d/1WHfBoQ9xZBG2Xk2PTTI4_TTjDC3LDm-V/view?usp=drive_link)


## Referencing FCM tokens

Device applications are uniquely identified by an FCM token generated by Google API.
For security reasons, these tokens are not visible on FCMPROXY.
Instead, an 8-digits string (FCMKEY) is generated by radiahub to reference the Google FCM token.


## radiahub message format

FCMPROXY API uses the following radiahub message format structure for sending and receiving messages:

Format:	JSON, JavaScript **plain** object

```javascript
var message = { 
	dataType: "some_data_type_string", 
	data: "Some_string_or_javascript_object"
}
```

Example:

```javascript
var message = { 
	dataType: "SELF_TEST", 
	data: {name:"Denis", lastname:"Auguste", instant:datetime.sql() }
}
```

For more information, please refer to [Initialize fcmproxy object](#initialize-fcmproxy-object) and [FCMPROXY reference](#fcmproxy-reference)

<br>

**Notices**: 

it is up to the receiving application to understand and process the parameters defined by the pair(dataType, data).

It is possible to send binary data (like file content) using this message format, provided:

- The binary data is dataURL-encoded (safest way),
- The total size of the message buffer is under 4KB

Exchanging files is possible:

1. Sender uploads the file to some server,
2. Sender sends the URL of the upload or some identifier referencing it via FCM/PCMPROXY to Receiver,
3. Receiver downloads from the server.


<br>&nbsp;
<br>

# Integration of your web site

You must embed your web site in radiahub proxy application, which provides a full-screen iframe in which your web site will run.

URL	: ```http://radiahub.22web.org/fcmproxy.php```

Method	: GET (preferred)

Parameters (GET)

<table>
	<tr>
		<th>Name</th>
		<th>Description</th>
		<th>Example</th>
		<th>Scope<th>
	</tr>
	<tr>
		<td>apikey</td>
		<td>Your API key</td>
		<td>10 digits code, ex 1234567890</td>
		<td>Mandatory</td>
	</tr>
	<tr>
		<td>overflow</td>
		<td>How the iframe window handles overflow</td>
		<td>Any valid CSS overflow style value, ex "auto", "hidden", etc.</td>
		<td>Optional, default "hidden"</td>
	</tr>
</table>

You may want to redirect the access point of your web site to the radiahub fcmproxy URL
For this, you have to rename the access point script (typically index.html or index.php, etc.) to some backup name, and implements a new access script.

Here is an example of basic script redirecting your site entry point to the iframe-based proxy:

```html
<html>
<head>
<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
<meta charset="UTF-8">
<script>
window.document.location = "http://radiahub.22web.org/fcmproxy.php?apikey=1234567890&overflow=hidden&title=My%20pretty%20website&url=https://path_to_my_website.html";
</script>
</head>
<body></body>
</html>
```

<b>Important</b><br/>
Like in the example above, do not forget that the location should be URL-encoded according to the script language in use (here, html and JavaScript)

<br>

## Download and bind script fcmproxy.js

### Download from GitHub repository

- [Download](https://github.com/radiahub/fcmproxy/blob/main/js/fcmproxy.js) fcmproxy.js
- [Clone](https://github.com/radiahub/fcmproxy/tree/main) GitHub repository

### Bind script

Example (minimized JavaScript file):

```html
<script src="fcmproxy.min.js"></script>
```

Binding script fcmproxy.js exposes a new object: fcmproxy

<br>

## Initialize fcmproxy object

call fcmproxy.init() as early as possible in your initialization script to register your callback function processing the **INCOMING** FCMPROXY messages.

Trivial examples:

```html
<html>
	<head>
		...
		<script src="fcmproxy.min.js"></script>
		...
		<script>
			const on_fcm_incoming_message = function(dataType, data) {
				console.info("IN on_fcm_incoming_message() dataType='" + dataType + "'");
				switch(dataType) {
					case "..." : {
						...
						break;
					}
				}
			};
		</script>
	</head>
	<body onload="fcmproxy.init(on_fcm_incoming_message);">
		...
	</body>
</html>
```

<br>

[More in the next section](#fcmproxy-reference) about fcmproxy.init(), fcmproxy.reg(), fcmproxy.unreg() managing the registration of callback processing the **INCOMING** FCMPROXY messages.

<br>&nbsp;
<br>

# FCMPROXY reference

## Bind fcmproxy to your website

```html
<script src="[path_to_lib/fcmproxy/]fcmproxy.min.js"></script>
```

Binding the JavaScript script exposes the fcmproxy object having following properties:

## fcmproxy object properties

fcmkey

callback

onmessage

onload

sendFCMmessage

init

reg

unreg

<br>

**Notice**:

The source code of the fcmproxy object is available on [GitHub](https://github.com/radiahub/fcmproxy)   


<br>&nbsp;
<br>

# Free code and free applications are **showcases** catching your attention!

This is definitively the primary goal!
The free applications are not only productive tools (just use them, they are free!), they introduce a little part of my commitment and my development work to you, with the hope that you will consider extending these applications to your specific needs, or develop your own software solution.


<br>&nbsp;
<br>

# API for manual handling of FCM tokens

**All radiahub** applications (websites and Android apps) 

- **automatically register** FCM tokens,
- **expose** the associated FCMKEYs to other application using setting pages, qr-codes, etc. when needed.

**FCMPROXY** exposes the FCMKEY associated to your web application's instance as ```fcmproxy.FCMKEY``` object property.

Nevertheless, while you develop your own application using FCMPROXY, you may want to 

- Register manually some FCM tokens and generate their associated FCMKEYs,
- Unregister those tokens when needed.

This API may be handy for this purpose.

<br>

**Important:**

To use this API, you must register for an API key 

	- at web page http://radiahub.22web.org/
	- [using Google Forms](https://docs.google.com/forms/d/e/1FAIpQLSfxhndoVHp21zhWzkvZysKdd58_5FXRy3CM_K9KMDqVJbyRcw/viewform?usp=publish-editor),
	- using radiahub authenticator application [download here](https://drive.google.com/file/d/1WHfBoQ9xZBG2Xk2PTTI4_TTjDC3LDm-V/view?usp=drive_link)

Notice that, as an attempt to discourage automatized token registration, this API is returning its result into an HTML page (free version only).

**Beware!**

The total number of registered FCM tokens, which can be manually registered using this API (and thus the number of manually created PINs) is limited to **10 tokens per API key** for the free version.

If you need to register more tokens, please feel free to [contact me here](https://radiahub.22web.org/?run=&view=contact)

<br>

## Register FCM token

This token-centric API registers tokens as created by Google Firebase Cloud Messaging for target identification and generates for each token the associated FCMKEY.

The URL points to a WEB page located at

URL			: https://radiahub.22web.org/fcmproxy.php?do=fcmreg&apikey=[your_API_key]&token=[token]

Method	: GET (preferred)

Parameters (GET)

<table>
	<tr>
		<th>Name</th>
		<th>Description</th>
		<th>Example</th>
		<th>Scope<th>
	</tr>
	<tr>
		<td>apikey</td>
		<td>Your API key</td>
		<td>10 digits code, ex 1234567890</td>
		<td>Mandatory</td>
	</tr>
	<tr>
		<td>token</td>
		<td>The FCM token as generated by Google FCM API (142 chars, alphanumeric)</td>
		<td>142 alphanumeric code, ex fjEKD5DSaVUUu0fJHyhz5e:APA91bGaKoQfcw_ ... 4-D2JcXl9aayUjJY3sst9wESH0</td>
		<td>Mandatory</td>
	</tr>
</table>


Return value (JSON format)

```json
{
	"errno"   : 1000,
	"errstr"  : "SUCCESS",
	"instant" : "2026-01-08 21:11:42",
	"PIN"     : "90933949"
}
```

<table>
	<tr>
		<th>Name</th>
		<th>Description</th>
		<th>Example</th>
	</tr>
	<tr>
		<td>errno</td>
		<td>4 digits error code, 1000 = SUCCESS</td>
		<td>1000</td>
	</tr>
	<tr>
		<td>errstr</td>
		<td>Textual description of the error code</td>
		<td>1000 = SUCCESS, 2003 = ACCOUNT IS NOT VALID, etc.</td>
	</tr>
	<tr>
		<td>instant</td>
		<td>WIT-based transaction instant in YYYY-MM-DD HH-MM-SS format</td>
		<td>2026-01-08 21:11:42</td>
	</tr>
	<tr>
		<td>PIN</td>
		<td>The radiahub PIN associated to the given token</td>
		<td>8-digits PIN value for the target associated with the token, ex 12345678</td>
	</tr>
</table>


<br>

## Unregister FCM token

This token-centric API deletes a (PIN,token) pair based on the values of tokens as created by Google Firebase Cloud Messaging.

The URL points to a WEB page located at

URL			: https://radiahub.22web.org/fcmproxy.php?do=fcmunreg&apikey=[your API key]&token=[token]

Method	: GET (preferred)

Parameters (GET)

<table>
	<tr>
		<th>Name</th>
		<th>Description</th>
		<th>Example</th>
		<th>Scope<th>
	</tr>
	<tr>
		<td>apikey</td>
		<td>Your API key</td>
		<td>10 digits code, ex 1234567890</td>
		<td>Mandatory</td>
	</tr>
	<tr>
		<td>token</td>
		<td>The FCM token as generated by Google FCM API (142 chars, alphanumeric) to unreg</td>
		<td>142 alphanumeric code, ex fjEKD5DSaVUUu0fJHyhz5e:APA91bGaKoQfcw_ ... 4-D2JcXl9aayUjJY3sst9wESH0</td>
		<td>Mandatory</td>
	</tr>
</table>


Return value (JSON format)

```json
{
	"errno"   : 1000,
	"errstr"  : "SUCCESS",
	"instant" : "2026-01-08 21:11:42"
}
```

<table>
	<tr>
		<th>Name</th>
		<th>Description</th>
		<th>Example</th>
	</tr>
	<tr>
		<td>errno</td>
		<td>4 digits error code, 1000 = SUCCESS</td>
		<td>1000</td>
	</tr>
	<tr>
		<td>errstr</td>
		<td>Textual description of the error code</td>
		<td>1000 = SUCCESS, 2003 = ACCOUNT IS NOT VALID, etc.</td>
	</tr>
	<tr>
		<td>instant</td>
		<td>WIT-based transaction instant in YYYY-MM-DD HH-MM-SS format</td>
		<td>2026-01-08 21:11:42</td>
	</tr>
</table>


<br>&nbsp;
<br>

# radiahub public repositories on GitHub

<table>
	<tr>
		<th>Description</th>
		<th>Link</th>
	</tr>
	<tr>
		<td>iframe-based proxy for easy Firebase Cloud Messaging instant messaging integration</td>
		<td><a href="https://github.com/radiahub/fcmproxy">https://github.com/radiahub/fcmproxy</a></td>
	</tr>
</table>

<br>
<br>

---
Copyright &copy; radiahub Denis Auguste Patrice 2026 - All rights reserved
